<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="https://kit.fontawesome.com/8aaf93a4a9.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
    <title>RSVP</title>
    <link rel="shortcut icon" type="image/png" href="/images/logo-small.png"/>
    <meta name="description" content="Form risposta">
</head>
<body class="max-width">
    <div class="container p-0 max-width">
        <nav class="d-flex justify-content-center max-width">
            <ul>
                <li><a href="/index.html" title="Homepage">Home</a></li>
                <li><a href="/giorno-speciale.html" title="RSVP">Un giorno speciale</a></li>
                <li><a href="/" title="Homepage">
                    <img src="https://res.cloudinary.com/driz5vgcs/image/upload/thumbnail_monogramma_fkvly8.png" class="logo d-inline" alt="logo small"/>
                    </a>
                <li class="active"><a href="#" title="RSVP">RSVP</a></li>
                <li><a href="/e-poi.html" title="... e poi?">.... e poi?</a></li>
            </ul>
        </nav>
    </div>
    <div class="mb-5 max-width">
        <div class="container form-container p-0 max-width">
            <img src="https://res.cloudinary.com/driz5vgcs/image/upload/160a8a57-454b-42d8-b5f6-b56c6085450c_hlhfgg.jpg" class="rsvp-background mb-5 max-width">
            <div class="overlay-form max-width">
                <h1 class="rsvp-headings">Vi aspettiamo!</h1>
                <h3 class="rsvp-headings mt-3 conferma-bottom">È gradita gentile conferma entro il 15 luglio 2024.</h2>
                <form id="form" class="max-width"
                    method="POST"
                    action="https://script.google.com/macros/s/AKfycbxZvh2WHvk_BpWx_kQ61sCB5q1QjYSLj6J1p9MOB1SFnBitp4_R8fDoLek6rziYkOE3xg/exec"
                >
                <input name="Nome" type="text" placeholder="Nome" required class="max-width-30">
                <input name="Cognome" type="text" placeholder="Cognome" required class="max-width-30">
                <select name="Menu" class="max-width-30">
                        <option value="" disabled selected>Menù</option>
                        <option value="Standard">Standard</option>
                        <option value="Vegetariano">Vegetariano</option>
                        <option value="Vegano">Vegano</option>
                        <option value="Senza lattosio">Senza lattosio</option>
                        <option value="Senza glutine">Senza glutine</option>
                </select>
                <br>
                <span class="rsvp-font">Per quanti ospiti stai confermando, oltre a te?</span>
                <select name="Ospiti" id="ospiti" class="ml max-width-50">
                    <option value="" disabled selected>Numero ospiti</option>
                    <option value = "Nessuno">Nessuno</option>
                    <option value = 1>1</option>
                    <option value = 2>2</option>
                    <option value = 3>3</option>
                    <option value = 4>4</option>
                    <option value = 5>5</option>
                    <option value = 6>6</option>
                </select>
                <div id="guestlist" class="max-width-50"></div>
                <br>
                <textarea name="Messaggio" rows="2" cols="38" placeholder="Altre note, allergie, messaggi per gli sposi?" ></textarea>
                <br>
                <button type="submit" value="Invia" class="invia">Invia</button>
                </form>
            </div>
        </div>
    </div>
    <div id="grazie-popup" class="grazie-popup max-width">
            <div class="closer">
                <svg class="closer" onclick="closeGraziePopup()" height="1.5rem" viewBox="0 0 24 24" width="2rem" xmlns="http://www.w3.org/2000/svg">
                        <title>Close icon</title>
                        <path d="M4 20L20 4M4 4l16 16" stroke="#440500" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
                </svg>
            </div>
            <h4>Grazie!</h4>
            <p>Abbiamo ricevuto la tua risposta</p>
        </div>
    <script>
        let graziePopup = document.getElementById("grazie-popup");

        document.querySelector("#ospiti").addEventListener("change", function(e){
            let ospiti = e.target.value;
            let guestlist = document.querySelector("#guestlist");
            guestlist.innerHTML = "";
            for (let i = 1; i <= ospiti; i++) {
                guestlist.innerHTML = guestlist.innerHTML + `<input name="Nome ospite ${i}" placeholder="Nome" class="max-width-30"></input>
                        <input name="Cognome ospite ${i}" placeholder="Cognome" class="max-width-30"></input>
                        <select name="Menu ospite ${i}" class="max-width-30">
                            <option value="" disabled selected>Menù</option>
                            <option value="Standard">Standard</option>
                            <option value="Vegetariano">Vegetariano</option>
                            <option value="Vegano">Vegano</option>
                            <option value="Senza lattosio">Senza lattosio</option>
                            <option value="Senza glutine">Senza glutine</option>
                        </select> <br>`
            }
        })

        function grazie() {
            graziePopup.classList.add("open-popup");
        }

        function closeGraziePopup() {
            event.preventDefault();
            graziePopup.classList.remove("open-popup");
        }

        window.addEventListener("DOMContentLoaded", function () {
            const yourForm = document.getElementById('form');
            yourForm.addEventListener("submit", function(e) {
                e.preventDefault();
                const data = new FormData(form);
                console.log(data);
                const action = e.target.action;
                fetch(action, { method: 'POST', body: data, })
                grazie();
             }); })
    </script>
</body>
</html>